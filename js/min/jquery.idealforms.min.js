/*--------------------------------------------------------------------------

  jq-idealforms 2.0

  * Author: Cedric Ruiz
  * License: GPL
  * Demo: http://elclanrs.github.com/jq-idealforms/

--------------------------------------------------------------------------*/(function(a){"use strict";var b={getMaxWidth:function(b){var c=0;return b.each(function(){a(this).outerWidth()>c&&(c=a(this).outerWidth())}),c},getLessVar:function(b,c){var d=a('<p class="'+b+'"></p>').hide().appendTo("body").css(c);return a("."+b).remove(),/^\d+/.test(d)?parseInt(d,10):d},getKeys:function(a){var b=[];for(var c in a)b.push(c);return b},isFunction:function(a){return typeof a=="function"},isRegex:function(a){return a instanceof RegExp},getByNameOrId:function(b){return a('[name="'+b+'"]').length?a('[name="'+b+'"]'):a("#"+b)},getInputType:function(a){var b=a.attr("type")||a[0].tagName.toLowerCase();return/(text|password|email|number|search|url|tel)/.test(b)&&"text"||/file/.test(b)&&"file"||/select/.test(b)&&"select"||/(radio|checkbox)/.test(b)&&"radiocheck"||/(button|submit|reset)/.test(b)&&"button"},makeInput:function(a,b,c){var d,e=[];/(text|password|email|number|search|url|tel|file)/.test(b)&&(d='<input type="'+b+'" id="'+a+'" name="'+a+'"/>');if(/select/.test(b)){e=[];for(var f=0,g=c.length;f<g;f++)e.push('<option value="'+c[f]+'">'+c[f]+"</option>");d='<select id="'+a+'" name="'+a+'">'+e.join("")+"</select>"}if(/(radio|checkbox)/.test(b)){e=[];for(var f=0,g=c.length;f<g;f++)e.push('<label><input type="'+b+'" name="'+a+'" value="'+c[f]+'" />'+c[f]+"</label>");d=e.join("")}return d}};a.fn.toCustomSelect=function(){return this.each(function(){var b=a(this),c=function(){var c=b.find("option"),d=a('<ul class="ideal-select '+b.attr("name")+'"/>'),e=a('<li><span class="title">'+c.filter(":selected").text()+"</span></li>"),f=function(){var b=[];return c.each(function(){var c=a(this);b.push('<li class="item" ideal-value="'+c.val()+'">'+c.text()+"</li>")}),b}();return e.append('<ul class="sub">'+f.join("")+"</ul>"),d.append(e),{options:c,select:d,title:e.find(".title"),sub:e.find(".sub"),items:e.find(".sub li")}}(),d={init:function(){b.css({position:"absolute",left:"-9999px"}),c.select.insertAfter(b),c.sub.hide(),c.items.eq(c.options.filter(":selected").index()).addClass("selected")}(),noWindowScroll:function(a){(a.which===40||a.which===38||a.which===13)&&a.preventDefault()},focusHack:function(){setTimeout(function(){b.trigger("focus")},1)},focus:function(){c.select.addClass("focus"),a(document).on("keydown.noscroll",d.noWindowScroll)},blur:function(){c.select.removeClass("open focus"),a(document).off(".noscroll")},scrollIntoView:function(a){var b=c.items.filter(".selected"),d=b.outerHeight(),e=c.sub.outerHeight(),f=function(){var c=b.position().top+d;return a==="down"?c<=e:c>0}();f||(d=a==="down"?d:-d,c.sub.scrollTop(c.sub.scrollTop()+d))},scrollToItem:function(){var a=c.items.filter(".selected").index(),b=c.items.outerHeight(),d=c.items.length,e=b*d,f=b*(d-a);c.sub.scrollTop(e-f)},showMenu:function(){c.sub.fadeIn("fast"),c.select.addClass("open"),d.select(c.options.filter(":selected").index()),d.scrollToItem()},hideMenu:function(){c.sub.hide(),c.select.removeClass("open")},select:function(a){c.items.removeClass("selected"),c.items.eq(a).addClass("selected")},change:function(a){var e=c.items.eq(a).text();d.select(a),c.title.text(e),c.options.eq(a).prop("selected",!0),b.trigger("change")},keydown:function(b){var e=c.items.filter(".selected").index(),f={9:function(){c.select.is(".menu")&&(d.blur(),d.hideMenu())},13:function(){c.select.is(".menu")&&(c.select.is(".open")?d.hideMenu():d.showMenu()),d.change(e)},27:function(){c.select.is(".menu")&&d.hideMenu()},40:function(){e<c.options.length-1&&(c.select.is(".open")?d.select(e+1):d.change(e+1)),d.scrollIntoView("down")},38:function(){e>0&&(c.select.is(".open")?d.select(e-1):d.change(e-1)),d.scrollIntoView("up")},"default":function(){var e=String.fromCharCode(b),f=c.items.filter(".selected").parent().index(),g=c.items.filter(function(){var b=new RegExp("^"+e,"i");return b.test(a(this).text())}).first().index();d.change(~g?g:f),d.scrollToItem(),d.focusHack()}};f[b]?f[b]():f["default"]()}},e={focus:d.focus,"blur.menu":function(){d.blur(),d.hideMenu()},"blur.list":function(){d.blur()},keydown:function(a){d.keydown(a.which)},"clickItem.menu":function(){d.change(a(this).index()),d.hideMenu()},"clickItem.list":function(){d.change(a(this).index())},"clickTitle.menu":function(){d.focus(),d.showMenu(),b.trigger("focus")},"hideOutside.menu":function(){b.off("blur.menu"),a(document).on("mousedown.ideal",function(f){a(f.target).closest(c.select).length?d.focusHack():(a(document).off("mousedown.ideal"),b.on("blur.menu",e["blur.menu"]))})},"mousedown.list":function(){d.focusHack()}},f=function(){c.select.removeClass("menu list"),b.off(".menu .list"),c.items.off(".menu .list"),c.select.off(".menu .list"),c.title.off(".menu .list")};c.select.on("menu",function(){f(),c.select.addClass("menu"),d.hideMenu(),b.on({"blur.menu":e["blur.menu"],"focus.menu":e.focus,"keydown.menu":e.keydown}),c.select.on("mousedown.menu",e["hideOutside.menu"]),c.items.on("click.menu",e["clickItem.menu"]),c.title.on("click.menu",e["clickTitle.menu"])}),c.select.on("list",function(){f(),c.select.addClass("list"),d.showMenu(),b.on({"blur.list":e["blur.list"],"focus.list":e.focus,"keydown.list":e.keydown}),c.select.on("mousedown.list",e["mousedown.list"]),c.items.on("mousedown.list",e["clickItem.list"])}),c.select.on("reset",function(){d.change(0)}),c.select.trigger("menu")})},a.fn.toCustomRadioCheck=function(){return this.each(function(){var b=a(this),c=a("<span/>");b.is(":checkbox")?c.addClass("ideal-check"):c.addClass("ideal-radio"),b.is(":checked")&&c.addClass("checked"),c.insertAfter(b),a(this).parent("label").attr("onclick",""),b.css({position:"absolute",left:"-9999px"}).on({change:function(){var b=a(this);b.trigger("focus"),b.is(":radio")?(b.parent().siblings("label").children(".ideal-radio").removeClass("checked"),b.is(":checked")&&b.next(".ideal-radio").addClass("checked")):b.is(":checked")?c.addClass("checked"):c.removeClass("checked")},focus:function(){c.parent().addClass("focus")},blur:function(){c.parent().removeClass("focus")},click:function(){a(this).trigger("focus")}})})},a.fn.toCustomFile=function(){return this.each(function(){var b=a(this),c=a('<div class="ideal-file-wrap">'),d=a('<input type="text" class="ideal-file-filename" />'),e=a('<button type="button" class="ideal-file-upload">Open</button>');b.css({position:"absolute",left:"-9999px"}),e.attr("tabIndex",-1).click(function(){b.trigger("click")}),b.attr("tabIndex",-1).on({change:function(){var c=typeof a("input")[0].multiple!="undefined",e=[],f,g;if(c){f=b[0].files;for(var h=0,i=f.length;h<i;h++)e.push(f[h].name);g=e.join(", ")}else g=b.val().split("\\").pop();d.val(g),d.attr("title",g)},focus:function(){d.trigger("focus")}}),d.on({keyup:function(){b.trigger("change")},focus:function(){b.trigger("change")},blur:function(){b.trigger("blur")},keydown:function(a){a.which===13&&b.trigger("click")}}),c.append(e,d).insertAfter(b)})};var c={required:{error:"This field is required"},number:{regex:/\d+/,error:"Must be a number."},digits:{regex:/^\d+$/,error:"Must be only digits."},name:{regex:/^[A-Za-z]{3,}$/,error:"Must be at least 3 characters long, and must only contain letters."},username:{regex:/^[a-z](?=[\w.]{3,31}$)\w*\.?\w*$/i,error:"Must be at between 4 and 32 characters long and start with a letter. You may use letters, numbers, underscores, and one dot (.)"},pass:{regex:/(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{6,}/,error:"Must be at least 6 characters long, and contain at least one number, one uppercase and one lowercase letter."},strongpass:{regex:/(?=^.{8,}$)((?=.*\d)|(?=.*\W+))(?![.\n])(?=.*[A-Z])(?=.*[a-z]).*$/,error:"Must be at least 8 characters long and contain at least one uppercase and one lowercase letter and one number or special character."},email:{regex:/[^@]+@[^@]/,error:"Must be a valid e-mail address. <em>(e.g. user@gmail.com)</em>"},phone:{regex:/^[2-9]\d{2}-\d{3}-\d{4}$/,error:"Must be a valid US phone number. <em>(e.g. 555-123-4567)</em>"},zip:{regex:/^\d{5}$|^\d{5}-\d{4}$/,error:"Must be a valid US zip code. <em>(e.g. 33245 or 33245-0003)</em>"},url:{regex:/^(?:(ftp|http|https):\/\/)?(?:[\w\-]+\.)+[a-z]{3,6}$/i,error:"Must be a valid URL. <em>(e.g. www.google.com)</em>"},min:{regex:function(a,b){var c=a.input,d=a.userOptions.data.min;return c.is(":checkbox, :radio")?(this.error="Check at least <strong>"+d+"</strong>",c.filter(":checked").length>=d):(this.error="Must be at least <strong>"+d+"</strong> characters long.",b.length>=d)}},max:{regex:function(a,b){var c=a.input,d=a.userOptions.data.max;return c.is(":checkbox, :radio")?(this.error="Check no more than <strong>"+d+"</strong>.",c.filter(":checked").length<=d):(this.error="<strong>"+d+"</strong> characters max.",b.length<=d)}},date:{regex:function(a,b){var c=a.userOptions.data?a.userOptions.data.date:"mm/dd/yyyy",d=/[^mdy]/.exec(c)[0],e=c.split(d),f=b.split(d),g=function(a,b){var c,d,e;for(var f=0,g=b.length;f<g;f++)/m/.test(b[f])&&(c=a[f]),/d/.test(b[f])&&(d=a[f]),/y/.test(b[f])&&(e=a[f]);return c>0&&c<13&&e&&e.length===4&&d>0&&d<=(new Date(e,c,0)).getDate()};return this.error="Must be a valid date. <em>(e.g. "+c+")</em>",g(f,e)}},exclude:{regex:function(b,c){return this.error='"'+c+'" is not available.',!~a.inArray(c,b.userOptions.data.exclude)}},equalto:{regex:function(b,c){var d=a(b.userOptions.data.equalto),e=b.input,f=d.attr("name")||d.attr("id");return this.error='Must be the same value as <strong>"'+f+'"</strong>',d.parents(".ideal-field").filter(function(){return a(this).data("isValid")===!1}).length?!1:e.val()===d.val()}},extension:{regex:function(a,b){var c=a.input[0].files||[{name:b}],d=a.userOptions.data.extension,e=new RegExp("\\."+d.join("|")+"$","i"),f=!1;for(var g=0,h=c.length;g<h;g++)e.test(c[g].name)?f=!0:f=!1;return this.error='File(s) must have a valid extension. <em>(e.g. "'+d.join('", "')+'")</em>',f}}},d={noerror:function(a){a.parent().siblings(".error").hide()},noicons:function(a){a.siblings(".valid-icon, .invalid-icon").hide()},novalidicon:function(a){a.siblings(".valid-icon").hide()},noinvalidicon:function(a){a.siblings(".invalid-icon").hide()},noclass:function(a){a.parents(".ideal-field").removeClass("valid invalid")},novalidclass:function(a){a.parents(".ideal-field").removeClass("valid")},noinvalidclass:function(a){a.parents(".ideal-field").removeClass("invalid")}};a.fn.idealforms=function(e){var f=a.extend({inputs:{},customFilters:{},customFlags:{},globalFlags:"",onSuccess:function(a){alert("Thank you...")},onFail:function(){alert("The form does not validate! Check again...")},responsiveAt:"auto",customInputs:!0},e),g=this,h=function(){return{inputs:g.find("input, select, textarea, :button"),labels:g.find("div > label:first-child"),text:g.find('input:not([type="checkbox"], [type="radio"]), textarea'),select:g.find("select"),radiocheck:g.find('input[type="radio"], input[type="checkbox"]'),buttons:g.find(":button"),file:g.find('[type="file"]')}},i=function(){return a('[name="'+b.getKeys(f.inputs).join('"], [name="')+'"],'+"."+b.getKeys(c).join(", ."))},j={fieldWidth:b.getLessVar("ideal-field-width","width")},k={doMarkup:function(c){var d=b.getInputType(c),e=function(){var b=a('<span class="error" />'),d=a('<i class="icon valid-icon" />'),e=a("<i/>",{"class":"icon invalid-icon",click:function(){var b=a(this);b.siblings("label").length?b.siblings("label:first").find("input").focus():b.siblings("input, select, textarea").focus()}});c.parents(".ideal-field").append(d.add(e).hide()).after(b.hide())},g={"default":function(){c.wrapAll('<span class="ideal-field"/>'),e()},button:function(){f.customInputs&&c.addClass("ideal-button")},file:function(){g["default"](),f.customInputs&&c.toCustomFile()},select:function(){g["default"](),f.customInputs&&c.toCustomSelect()},text:function(){g["default"]()},radiocheck:function(){var a=c.parents(".ideal-field").length,b=c.parent().siblings("label:not(:first)").andSelf();f.customInputs&&c.toCustomRadioCheck();if(!!a)return!1;b.wrapAll('<span class="ideal-field ideal-radiocheck"/>'),e()}};c.closest("div").addClass("ideal-wrap"),g[d]()},adjust:function(){var c=h();c.inputs.attr("autocomplete","off"),c.labels.addClass("ideal-label").width(b.getMaxWidth(c.labels)),"placeholder"in a("<input/>")[0]||c.text.each(function(){a(this).val(a(this).attr("placeholder"))}).on({focus:function(){this.value===a(this).attr("placeholder")&&a(this).val("")},blur:function(){a(this).val()||a(this).val(a(this).attr("placeholder"))}})},init:function(){var b=h();g.css("visibility","visible").addClass("ideal-form"),g.attr("novalidate","novalidate"),k.adjust(),b.inputs.each(function(){k.doMarkup(a(this))})},validate:function(a,d){var e=!0,f="",g=a.input,h=a.userOptions,i=h.filters;if(i){!d&&/required/.test(i)&&(f=h.errors&&h.errors.required?h.errors.required:c.required.error,e=!1);if(d){i=i.split(/\s/);for(var j=0,k=i.length;j<k;j++){var l=i[j],m=c[l]||"";if(m&&(b.isFunction(m.regex)&&!m.regex(a,d)||b.isRegex(m.regex)&&!m.regex.test(d))){e=!1,f=h.errors&&h.errors[l]||m.error;break}}}}return{isValid:e,error:f}},analyze:function(a,b){var c=a.is('[type="checkbox"], [type="radio"]'),e=a.is('[type="file"]'),h=function(){var b=i();return c?b.filter('[name="'+a.attr("name")+'"]'):b.filter(a)}(),j=f.inputs[a.attr("name")]||{filters:a.attr("class")},l=function(){var b=a.val();if(b===a.attr("placeholder"))return;return c?j&&" ":b}(),m=a.parents(".ideal-field"),n=m.next(".error"),p=function(){return c?a.parent().siblings(".invalid-icon"):a.siblings(".invalid-icon")}(),q=function(){return c?a.parent().siblings(".valid-icon"):a.siblings(".valid-icon")}(),r=k.validate({input:h,userOptions:j},l),s=function(){var a=j.flags?j.flags:"";return f.globalFlags&&(a+=f.globalFlags),a.split(/\s/)}(),t=function(){for(var a=0,c=s.length,e;a<c;a++){e=s[a];if(!d[e])break;d[e](h,b)}};m.removeClass("valid invalid").data("isValid",!0),n.add(p).add(q).hide(),l&&r.isValid&&(n.add(p).hide(),m.addClass("valid").data("isValid",!0),q.show()),r.isValid||(p.show(),m.addClass("invalid").data("isValid",!1),g.find(".error").hide(),b!=="blur"&&n.html(r.error).show()),t()},attachEvents:function(){i().on("keyup change focus blur",function(b){k.analyze(a(this),b.type)})},responsive:function(){var b=h(),c=j.fieldWidth+b.labels.outerWidth(),d=b.labels.filter(function(){return a(this).html()==="&nbsp;"}),e=g.find(".ideal-select");f.responsiveAt==="auto"?g.outerWidth()<c?g.addClass("stack"):g.removeClass("stack"):a(window).width()<f.responsiveAt?g.addClass("stack"):g.removeClass("stack"),g.is(".stack")?(d.hide(),e.trigger("list")):(d.show(),e.trigger("menu"))}},l={addFields:function(c){c=c.reverse();var d=function(c){var d=c.addAfter?a(b.getByNameOrId(c.addAfter)).parents(".ideal-wrap"):g.find(".ideal-wrap").last(),e=c.name,h={filters:c.filters||"",data:c.data||{},errors:c.errors||{},flags:c.flags||""},i=c.title,j=c.type,l=c.list||"",m=a("<div><label>"+i+":</label>"+b.makeInput(e,j,l)+"</div>"),n=m.find("input, select, textarea, :button");h.filters&&(f.inputs[e]=h),k.doMarkup(n),m.insertAfter(d)};for(var e=0,h=c.length;e<h;e++)d(c[e]);return g.reload(),g},getInvalid:function(){return g.find(".ideal-field").filter(function(){return a(this).data("isValid")===!1})},isValid:function(){return!g.getInvalid().length},isValidField:function(a){var c=b.getByNameOrId(a);return c.parents(".ideal-field").data("isValid")===!0},focusFirst:function(){return g.find("input:first").focus(),g},focusFirstInvalid:function(){return g.getInvalid().first().find("input:first").focus(),g},fresh:function(){return i().blur().parents(".ideal-field").removeClass("valid invalid"),g},reload:function(){k.adjust(),k.attachEvents(),g.fresh()},reset:function(){var a=h();return a.text.val(""),a.radiocheck.removeAttr("checked"),a.select.find("option").first().prop("selected",!0),g.find(".ideal-select").trigger("reset"),a.inputs.change().blur(),g.focusFirst(),g}};for(var m in l)g[m]=l[m];return g.on({keydown:function(a){a.which===13&&a.preventDefault()},submit:function(a){g.isValid()?f.onSuccess(a):(a.preventDefault(),f.onFail(),g.focusFirstInvalid())}}),f.responsiveAt&&(a(window).resize(k.responsive),k.responsive()),a.extend(!0,c,f.customFilters),a.extend(!0,d,f.customFlags),k.init(),k.attachEvents(),g.fresh(),this}})(jQuery);