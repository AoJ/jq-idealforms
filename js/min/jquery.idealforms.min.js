/*--------------------------------------------------------------------------

  jq-idealforms 2.0

  * Author: Cedric Ruiz
  * License: GPL
  * Demo: http://elclanrs.github.com/jq-idealforms/

--------------------------------------------------------------------------*/(function(e){"use strict";e.idealforms={};var t={getMaxWidth:function(t){var n=0;return t.each(function(){e(this).outerWidth()>n&&(n=e(this).outerWidth())}),n},getLessVar:function(t,n){var r=e('<p class="'+t+'"></p>').hide().appendTo("body").css(n);return e("."+t).remove(),/^\d+/.test(r)?parseInt(r,10):r},getKeys:function(e){var t=[];for(var n in e)t.push(n);return t},isFunction:function(e){return typeof e=="function"},isRegex:function(e){return e instanceof RegExp},getByNameOrId:function(t){return e('[name="'+t+'"]').length?e('[name="'+t+'"]'):e("#"+t)},getIdealType:function(e){var t=e.attr("type")||e[0].tagName.toLowerCase();return/(text|password|email|number|search|url|tel)/.test(t)&&"text"||/file/.test(t)&&"file"||/select/.test(t)&&"select"||/(radio|checkbox)/.test(t)&&"radiocheck"||/(button|submit|reset)/.test(t)&&"button"||/h\d/.test(t)&&"description"||/hr/.test(t)&&"separator"},makeInput:function(e,t,n){var r,i=[],s,o;/(text|password|email|number|search|url|tel|file)/.test(t)&&(r='<input type="'+t+'" id="'+e+'" name="'+e+'"/>');if(/select/.test(t)){i=[];for(s=0,o=n.length;s<o;s++)i.push('<option value="'+n[s]+'">'+n[s]+"</option>");r='<select id="'+e+'" name="'+e+'">'+i.join("")+"</select>"}if(/(radio|checkbox)/.test(t)){i=[];for(s=0,o=n.length;s<o;s++)i.push('<label><input type="'+t+'" name="'+e+'" value="'+n[s]+'" />'+n[s]+"</label>");r=i.join("")}return r}};e.fn.toCustomSelect=function(){return this.each(function(){var t=e(this),n=function(){var n=t.find("option"),r=e('<ul class="ideal-select '+t.attr("name")+'"/>'),i=e('<li><span class="title">'+n.filter(":selected").text()+"</span></li>"),s=function(){var t=[];return n.each(function(){var n=e(this);t.push('<li class="item" ideal-value="'+n.val()+'">'+n.text()+"</li>")}),t}();return i.append('<ul class="sub">'+s.join("")+"</ul>"),r.append(i),{options:n,select:r,title:i.find(".title"),sub:i.find(".sub"),items:i.find(".sub li")}}(),r={init:function(){t.css({position:"absolute",left:"-9999px"}),n.select.insertAfter(t),n.sub.hide(),n.items.eq(n.options.filter(":selected").index()).addClass("selected")}(),noWindowScroll:function(e){(e.which===40||e.which===38||e.which===13)&&e.preventDefault()},focusHack:function(){setTimeout(function(){t.trigger("focus")},1)},focus:function(){n.select.addClass("focus"),e(document).on("keydown.noscroll",r.noWindowScroll)},blur:function(){n.select.removeClass("open focus"),e(document).off(".noscroll")},scrollIntoView:function(e){var t=n.items.filter(".selected"),r=t.outerHeight(),i=n.sub.outerHeight(),s=function(){var n=t.position().top+r;return e==="down"?n<=i:n>0}();s||(r=e==="down"?r:-r,n.sub.scrollTop(n.sub.scrollTop()+r))},scrollToItem:function(){var e=n.items.filter(".selected").index(),t=n.items.outerHeight(),r=n.items.length,i=t*r,s=t*(r-e);n.sub.scrollTop(i-s)},showMenu:function(){n.sub.fadeIn("fast"),n.select.addClass("open"),r.select(n.options.filter(":selected").index()),r.scrollToItem()},hideMenu:function(){n.sub.hide(),n.select.removeClass("open")},select:function(e){n.items.removeClass("selected"),n.items.eq(e).addClass("selected")},change:function(e){var i=n.items.eq(e).text();r.select(e),n.title.text(i),n.options.eq(e).prop("selected",!0),t.trigger("change")},keydown:function(t){var i=n.items.filter(".selected").index(),s={9:function(){n.select.is(".menu")&&(r.blur(),r.hideMenu())},13:function(){n.select.is(".menu")&&(n.select.is(".open")?r.hideMenu():r.showMenu()),r.change(i)},27:function(){n.select.is(".menu")&&r.hideMenu()},40:function(){i<n.options.length-1&&(n.select.is(".open")?r.select(i+1):r.change(i+1)),r.scrollIntoView("down")},38:function(){i>0&&(n.select.is(".open")?r.select(i-1):r.change(i-1)),r.scrollIntoView("up")},"default":function(){var i=String.fromCharCode(t),s=n.items.filter(".selected").parent().index(),o=n.items.filter(function(){var t=new RegExp("^"+i,"i");return t.test(e(this).text())}).first().index();r.change(~o?o:s),r.scrollToItem(),r.focusHack()}};s[t]?s[t]():s["default"]()}},i={focus:r.focus,"blur.menu":function(){r.blur(),r.hideMenu()},"blur.list":function(){r.blur()},keydown:function(e){r.keydown(e.which)},"clickItem.menu":function(){r.change(e(this).index()),r.hideMenu()},"clickItem.list":function(){r.change(e(this).index())},"clickTitle.menu":function(){r.focus(),r.showMenu(),t.trigger("focus")},"hideOutside.menu":function(){t.off("blur.menu"),e(document).on("mousedown.ideal",function(s){e(s.target).closest(n.select).length?r.focusHack():(e(document).off("mousedown.ideal"),t.on("blur.menu",i["blur.menu"]))})},"mousedown.list":function(){r.focusHack()}},s=function(){n.select.removeClass("menu list"),t.off(".menu .list"),n.items.off(".menu .list"),n.select.off(".menu .list"),n.title.off(".menu .list")};n.select.on("menu",function(){s(),n.select.addClass("menu"),r.hideMenu(),t.on({"blur.menu":i["blur.menu"],"focus.menu":i.focus,"keydown.menu":i.keydown}),n.select.on("mousedown.menu",i["hideOutside.menu"]),n.items.on("click.menu",i["clickItem.menu"]),n.title.on("click.menu",i["clickTitle.menu"])}),n.select.on("list",function(){s(),n.select.addClass("list"),r.showMenu(),t.on({"blur.list":i["blur.list"],"focus.list":i.focus,"keydown.list":i.keydown}),n.select.on("mousedown.list",i["mousedown.list"]),n.items.on("mousedown.list",i["clickItem.list"])}),n.select.on("reset",function(){r.change(0)}),n.select.trigger("menu")})},e.fn.toCustomRadioCheck=function(){return this.each(function(){var t=e(this),n=e("<span/>");t.is(":checkbox")?n.addClass("ideal-check"):n.addClass("ideal-radio"),t.is(":checked")&&n.addClass("checked"),n.insertAfter(t),e(this).parent("label").attr("onclick",""),t.css({position:"absolute",left:"-9999px"}).on({change:function(){var t=e(this);t.trigger("focus"),t.is(":radio")?(t.parent().siblings("label").children(".ideal-radio").removeClass("checked"),t.is(":checked")&&t.next(".ideal-radio").addClass("checked")):t.is(":checked")?n.addClass("checked"):n.removeClass("checked")},focus:function(){n.parent().addClass("focus")},blur:function(){n.parent().removeClass("focus")},click:function(){e(this).trigger("focus")}})})},e.fn.toCustomFile=function(){return this.each(function(){var t=e(this),n=e('<div class="ideal-file-wrap">'),r=e('<input type="text" class="ideal-file-filename" />'),i=e('<button type="button" class="ideal-file-upload">Open</button>');t.css({position:"absolute",left:"-9999px"}),i.attr("tabIndex",-1).click(function(){t.trigger("click")}),t.attr("tabIndex",-1).on({change:function(){var n=typeof e("input")[0].multiple!="undefined",i=[],s,o;if(n){s=t[0].files;for(var u=0,a=s.length;u<a;u++)i.push(s[u].name);o=i.join(", ")}else o=t.val().split("\\").pop();r.val(o),r.attr("title",o)},focus:function(){r.trigger("focus")}}),r.on({keyup:function(){t.trigger("change")},focus:function(){t.trigger("change")},blur:function(){t.trigger("blur")},keydown:function(e){e.which===13&&t.trigger("click")}}),n.append(i,r).insertAfter(t)})},e.idealforms.errors={required:"This field is required.",number:"Must be a number.",digits:"Must be only digits.",name:"Must be at least 3 characters long, and must only contain letters.",username:"Must be at between 4 and 32 characters long and start with a letter. You may use letters, numbers, underscores, and one dot (.)",pass:"Must be at least 6 characters long, and contain at least one number, one uppercase and one lowercase letter.",strongpass:"Must be at least 8 characters long and contain at least one uppercase and one lowercase letter and one number or special character.",email:"Must be a valid e-mail address. <em>(e.g. user@gmail.com)</em>",phone:"Must be a valid US phone number. <em>(e.g. 555-123-4567)</em>",zip:"Must be a valid US zip code. <em>(e.g. 33245 or 33245-0003)</em>",url:"Must be a valid URL. <em>(e.g. www.google.com)</em>",min:"Must be at least <strong>{0}</strong> characters long.",minOption:"Check at least <strong>{0}</strong> options.",max:"No more than <strong>{0}</strong> characters long.",maxOption:"No more than <strong>{0}</strong> options allowed.",date:"Must be a valid date. <em>(e.g. {0})</em>",exclude:'"{0}" is not available.',excludeOption:"{0}",equalto:'Must be the same value as <strong>"{0}"</strong>',extension:'File(s) must have a valid extension. <em>(e.g. "{0}")</em>'};var n=function(){return{required:{error:e.idealforms.errors.required},number:{regex:/\d+/,error:e.idealforms.errors.number},digits:{regex:/^\d+$/,error:e.idealforms.errors.digits},name:{regex:/^[A-Za-z]{3,}$/,error:e.idealforms.errors.name},username:{regex:/^[a-z](?=[\w.]{3,31}$)\w*\.?\w*$/i,error:e.idealforms.errors.username},pass:{regex:/(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{6,}/,error:e.idealforms.errors.pass},strongpass:{regex:/(?=^.{8,}$)((?=.*\d)|(?=.*\W+))(?![.\n])(?=.*[A-Z])(?=.*[a-z]).*$/,error:e.idealforms.errors.strongpass},email:{regex:/[^@]+@[^@]/,error:e.idealforms.errors.email},phone:{regex:/^[2-9]\d{2}-\d{3}-\d{4}$/,error:e.idealforms.errors.phone},zip:{regex:/^\d{5}$|^\d{5}-\d{4}$/,error:e.idealforms.errors.zip},url:{regex:/^(?:(ftp|http|https):\/\/)?(?:[\w\-]+\.)+[a-z]{3,6}$/i,error:e.idealforms.errors.url},min:{regex:function(t,n){var r=t.input,i=t.userOptions.data.min;return r.is('[type="checkbox"], [type="radio"], select')?(this.error=e.idealforms.errors.minOption.replace("{0}",i),r.filter(":checked").length>=i):(this.error=e.idealforms.errors.minOption.replace("{0}",i),n.length>=i)}},max:{regex:function(t,n){var r=t.input,i=t.userOptions.data.max;return r.is('[type="checkbox"], [type="radio"], select')?(this.error=e.idealforms.errors.maxOption.replace("{0}",i),r.filter(":checked").length<=i):(this.error=e.idealforms.errors.max.replace("{0}",i),n.length<=i)}},date:{regex:function(t,n){var r=t.userOptions.data?t.userOptions.data.date:"mm/dd/yyyy",i=/[^mdy]/.exec(r)[0],s=r.split(i),o=n.split(i),u=function(e,t){var n,r,i;for(var s=0,o=t.length;s<o;s++)/m/.test(t[s])&&(n=e[s]),/d/.test(t[s])&&(r=e[s]),/y/.test(t[s])&&(i=e[s]);return n>0&&n<13&&i&&i.length===4&&r>0&&r<=(new Date(i,n,0)).getDate()};return this.error=e.idealforms.errors.date.replace("{0}",r),u(o,s)}},exclude:{regex:function(t,n){var r=t.input;return r.is('[type="checkbox"], [type="radio"], select')?this.error=e.idealforms.errors.excludeOption.replace("{0}",n):e.idealforms.errors.exclude.replace("{0}",n),!~e.inArray(n,t.userOptions.data.exclude)}},equalto:{regex:function(t,n){var r=e(t.userOptions.data.equalto),i=t.input,s=r.attr("name")||r.attr("id"),o=r.parents(".ideal-field").filter(function(){return e(this).data("isValid")===!0}).length;return o?(this.error=e.idealforms.errors.equalto.replace("{0}",s),i.val()===r.val()):!1}},extension:{regex:function(t,n){var r=t.input[0].files||[{name:n}],i=t.userOptions.data.extension,s=new RegExp("\\."+i.join("|")+"$","i"),o=!1;for(var u=0,a=r.length;u<a;u++)o=s.test(r[u].name)?!0:!1;return this.error=e.idealforms.errors.extension.replace("{0}",i.join('", "')),o}}}},r={noerror:function(e){e.parent().siblings(".error").hide()},noicons:function(e){e.siblings(".valid-icon, .invalid-icon").hide()},novalidicon:function(e){e.siblings(".valid-icon").hide()},noinvalidicon:function(e){e.siblings(".invalid-icon").hide()},noclass:function(e){e.parents(".ideal-field").removeClass("valid invalid")},novalidclass:function(e){e.parents(".ideal-field").removeClass("valid")},noinvalidclass:function(e){e.parents(".ideal-field").removeClass("invalid")}};e.fn.idealforms=function(i){var s=e.extend({inputs:{},customFilters:{},customFlags:{},globalFlags:"",onSuccess:function(e){alert("Thank you...")},onFail:function(){alert("The form does not validate! Check again...")},responsiveAt:"auto",customInputs:!0},i),o=this,u=n(),a=function(){return{inputs:o.find("input, select, textarea, :button"),labels:o.find("div > label:first-child"),text:o.find('input:not([type="checkbox"], [type="radio"]), textarea'),select:o.find("select"),radiocheck:o.find('input[type="radio"], input[type="checkbox"]'),buttons:o.find(":button"),file:o.find('input[type="file"]'),headings:o.find("h1, h2, h3, h4, h5, p"),separators:o.find("hr")}},f=function(){return e('[name="'+t.getKeys(s.inputs).join('"], [name="')+'"],'+"."+t.getKeys(u).join(", ."))},l={fieldWidth:t.getLessVar("ideal-field-width","width")},c={doMarkup:function(n){var r=t.getIdealType(n),i=function(){var t=e('<span class="error" />'),r=e('<i class="icon valid-icon" />'),i=e("<i/>",{"class":"icon invalid-icon",click:function(){var t=e(this);t.siblings("label").length?t.siblings("label:first").find("input").focus():t.siblings("input, select, textarea").focus()}});n.parents(".ideal-field").append(r.add(i).hide()).after(t.hide())},o={"default":e.noop,defaultInput:function(){n.wrapAll('<span class="ideal-field"/>'),i()},button:function(){s.customInputs&&n.addClass("ideal-button")},file:function(){o.defaultInput(),s.customInputs&&n.toCustomFile()},select:function(){o.defaultInput(),s.customInputs&&n.toCustomSelect()},text:function(){o.defaultInput()},radiocheck:function(){var e=n.parents(".ideal-field").length,t=n.parent().siblings("label:not(:first)").andSelf();s.customInputs&&n.toCustomRadioCheck();if(!!e)return!1;t.wrapAll('<span class="ideal-field ideal-radiocheck"/>'),i()},description:function(){var e=n.parents(".ideal-field").length,t=n.siblings().andSelf();e||t.wrapAll('<span class="ideal-heading"/>')},separator:function(){n.wrapAll('<div class="ideal-separator"/>')}};n.closest("div").addClass("ideal-wrap"),o[r]?o[r]():o["default"]()},adjust:function(){var n=a();n.inputs.attr("autocomplete","off"),n.labels.addClass("ideal-label").width(t.getMaxWidth(n.labels)),n.headings.add(n.separators).width(o.width()).first().parent().addClass("ideal-heading-first"),"placeholder"in e("<input/>")[0]||n.text.each(function(){e(this).val(e(this).attr("placeholder"))}).on({focus:function(){this.value===e(this).attr("placeholder")&&e(this).val("")},blur:function(){e(this).val()||e(this).val(e(this).attr("placeholder"))}})},init:function(){var t=a();o.css("visibility","visible").addClass("ideal-form"),o.attr("novalidate","novalidate"),t.inputs.add(t.headings).add(t.separators).each(function(){c.doMarkup(e(this))}),c.adjust()},validate:function(e,n){var r=!0,i="",s=e.input,o=e.userOptions,a=o.filters;if(a){!n&&/required/.test(a)&&(i=o.errors&&o.errors.required?o.errors.required:u.required.error,r=!1);if(n){a=a.split(/\s/);for(var f=0,l=a.length;f<l;f++){var c=a[f],h=u[c]||{};if(h&&(t.isFunction(h.regex)&&!h.regex(e,n)||t.isRegex(h.regex)&&!h.regex.test(n))){r=!1,i=o.errors&&o.errors[c]||h.error;break}}}}return{isValid:r,error:i}},analyze:function(e,t){var n=e.is('[type="checkbox"], [type="radio"]'),i=function(){var t=f();return n?t.filter('[name="'+e.attr("name")+'"]'):t.filter(e)}(),u=s.inputs[e.attr("name")]||{filters:e.attr("class")},a=function(){var t=e.val();if(t===e.attr("placeholder"))return;return n?u&&" ":t}(),l=e.parents(".ideal-field"),h=l.next(".error"),p=function(){return n?e.parent().siblings(".invalid-icon"):e.siblings(".invalid-icon")}(),d=function(){return n?e.parent().siblings(".valid-icon"):e.siblings(".valid-icon")}(),v=c.validate({input:i,userOptions:u},a),m=function(){var e=u.flags?u.flags:"";return s.globalFlags&&(e+=s.globalFlags),e.split(/\s/)}(),g=function(){for(var e=0,n=m.length,s;e<n;e++){s=m[e];if(!r[s])break;r[s](i,t)}};l.removeClass("valid invalid").data("isValid",!0),h.add(p).add(d).hide(),a&&v.isValid&&(h.add(p).hide(),l.addClass("valid").data("isValid",!0),d.show()),v.isValid||(p.show(),l.addClass("invalid").data("isValid",!1),o.find(".error").hide(),t!=="blur"&&h.html(v.error).show()),g()},attachEvents:function(){f().on("keyup change focus blur",function(t){c.analyze(e(this),t.type)})},responsive:function(){var t=a(),n=l.fieldWidth+t.labels.outerWidth(),r=t.labels.filter(function(){return e(this).html()==="&nbsp;"}),i=o.find(".ideal-select");s.responsiveAt==="auto"?o.width()<n?o.addClass("stack"):o.removeClass("stack"):e(window).width()<s.responsiveAt?o.addClass("stack"):o.removeClass("stack"),o.is(".stack")?(r.hide(),i.trigger("list")):(r.show(),i.trigger("menu"))}},h={addFields:function(n){n=n.reverse();var r=function(n){var r=n.addAfter?e(t.getByNameOrId(n.addAfter)).parents(".ideal-wrap"):o.find(".ideal-wrap").last(),i=n.name,u={filters:n.filters||"",data:n.data||{},errors:n.errors||{},flags:n.flags||""},a=n.title,f=n.type,l=n.list||"",h=e("<div><label>"+a+":</label>"+t.makeInput(i,f,l)+"</div>"),p=h.find("input, select, textarea, :button");u.filters&&(s.inputs[i]=u),c.doMarkup(p),h.insertAfter(r)};for(var i=0,u=n.length;i<u;i++)r(n[i]);return o.reload(),o},getInvalid:function(){return o.find(".ideal-field").filter(function(){return e(this).data("isValid")===!1})},isValid:function(){return!o.getInvalid().length},isValidField:function(e){var n=t.getByNameOrId(e);return n.parents(".ideal-field").data("isValid")===!0},focusFirst:function(){return o.find("input:first").focus(),o},focusFirstInvalid:function(){return o.getInvalid().first().find("input:first").focus(),o},fresh:function(){return f().blur().parents(".ideal-field").removeClass("valid invalid"),o},reload:function(){c.adjust(),c.attachEvents(),o.fresh()},reset:function(){var e=a();return e.text.val(""),e.radiocheck.removeAttr("checked"),e.select.find("option").first().prop("selected",!0),o.find(".ideal-select").trigger("reset"),e.inputs.change().blur(),o.focusFirst(),o}};for(var p in h)o[p]=h[p];return o.on({keydown:function(e){e.which===13&&e.preventDefault()},submit:function(e){o.isValid()?s.onSuccess(e):(e.preventDefault(),s.onFail(),o.focusFirstInvalid())}}),s.responsiveAt&&(e(window).resize(c.responsive),c.responsive()),e.extend(!0,u,s.customFilters),e.extend(!0,r,s.customFlags),c.init(),c.attachEvents(),o.fresh(),this}})(jQuery);