/*--------------------------------------------------------------------------

  jq-idealforms 2.0

  * Author: Cedric Ruiz
  * License: GPL
  * Demo: http://elclanrs.github.com/jq-idealforms/

--------------------------------------------------------------------------*/(function(e){"use strict";var t={getMaxWidth:function(t){var n=0;return t.each(function(){e(this).outerWidth()>n&&(n=e(this).outerWidth())}),n},getLessVar:function(t,n){var r=e('<p class="'+t+'"></p>').hide().appendTo("body").css(n);return e("."+t).remove(),/^\d+/.test(r)?parseInt(r,10):r},getKeys:function(e){var t=[];for(var n in e)t.push(n);return t},isFunction:function(e){return typeof e=="function"},isRegex:function(e){return e instanceof RegExp}};e.fn.toCustomSelect=function(){return this.each(function(){var t=e(this),n=function(){var n=t.find("option"),r=e('<ul class="ideal-select '+t.attr("name")+'"/>'),i=e('<li><span class="title">'+n.filter(":selected").text()+"</span></li>"),s=function(){var t=[];return n.each(function(){var n=e(this);t.push('<li class="item" ideal-value="'+n.val()+'">'+n.text()+"</li>")}),t}();return i.append('<ul class="sub">'+s.join("")+"</ul>"),r.append(i),{options:n,select:r,title:i.find(".title"),sub:i.find(".sub"),items:i.find(".sub li")}}(),r={init:function(){t.css({position:"absolute",left:"-9999px"}),n.select.insertAfter(t),n.sub.hide(),n.items.eq(n.options.filter(":selected").index()).addClass("selected")}(),noWindowScroll:function(e){(e.which===40||e.which===38||e.which===13)&&e.preventDefault()},focusHack:function(){setTimeout(function(){t.trigger("focus")},1)},focus:function(){n.select.addClass("focus"),e(document).on("keydown.noscroll",r.noWindowScroll)},blur:function(){n.select.removeClass("open focus"),e(document).off(".noscroll")},scrollIntoView:function(e){var t=n.items.filter(".selected"),r=t.outerHeight(),i=n.sub.outerHeight(),s=function(){var n=t.position().top+r;return e==="down"?n<=i:n>0}();s||(r=e==="down"?r:-r,n.sub.scrollTop(n.sub.scrollTop()+r))},scrollToItem:function(){var e=n.items.filter(".selected").index(),t=n.items.outerHeight(),r=n.items.length,i=t*r,s=t*(r-e);n.sub.scrollTop(i-s)},showMenu:function(){n.sub.fadeIn("fast"),n.select.addClass("open"),r.select(n.options.filter(":selected").index()),r.scrollToItem()},hideMenu:function(){n.sub.hide(),n.select.removeClass("open")},select:function(e){n.items.removeClass("selected"),n.items.eq(e).addClass("selected")},change:function(e){var i=n.items.eq(e).text();r.select(e),n.title.text(i),n.options.eq(e).prop("selected",!0),t.trigger("change")},keydown:function(t){var i=n.items.filter(".selected").index(),s={9:function(){n.select.is(".menu")&&(r.blur(),r.hideMenu())},13:function(){n.select.is(".menu")&&(n.select.is(".open")?r.hideMenu():r.showMenu()),r.change(i)},27:function(){n.select.is(".menu")&&r.hideMenu()},40:function(){i<n.options.length-1&&(n.select.is(".open")?r.select(i+1):r.change(i+1)),r.scrollIntoView("down")},38:function(){i>0&&(n.select.is(".open")?r.select(i-1):r.change(i-1)),r.scrollIntoView("up")},"default":function(){var i=String.fromCharCode(t),s=n.items.filter(".selected").parent().index(),o=n.items.filter(function(){var t=new RegExp("^"+i,"i");return t.test(e(this).text())}).first().index();r.change(~o?5:s),r.scrollToItem(),r.focusHack()}};s[t]?s[t]():s["default"]()}},i={focus:r.focus,"blur.menu":function(){r.blur(),r.hideMenu()},"blur.list":function(){r.blur()},keydown:function(e){r.keydown(e.which)},"clickItem.menu":function(){r.change(e(this).index()),r.hideMenu()},"clickItem.list":function(){r.change(e(this).index())},"clickTitle.menu":function(){r.focus(),r.showMenu(),t.trigger("focus")},"hideOutside.menu":function(){t.off("blur.menu"),e(document).on("mousedown.ideal",function(s){e(s.target).closest(n.select).length?r.focusHack():(e(document).off("mousedown.ideal"),t.on("blur.menu",i["blur.menu"]))})},"mousedown.list":function(){r.focusHack()}},s=function(){n.select.removeClass("menu list"),t.off(".menu .list"),n.items.off(".menu .list"),n.select.off(".menu .list"),n.title.off(".menu .list")};n.select.on("menu",function(){s(),n.select.addClass("menu"),r.hideMenu(),t.on({"blur.menu":i["blur.menu"],"focus.menu":i.focus,"keydown.menu":i.keydown}),n.select.on("mousedown.menu",i["hideOutside.menu"]),n.items.on("click.menu",i["clickItem.menu"]),n.title.on("click.menu",i["clickTitle.menu"])}),n.select.on("list",function(){s(),n.select.addClass("list"),r.showMenu(),t.on({"blur.list":i["blur.list"],"focus.list":i.focus,"keydown.list":i.keydown}),n.select.on("mousedown.list",i["mousedown.list"]),n.items.on("mousedown.list",i["clickItem.list"])}),n.select.on("reset",function(){r.change(0)}),n.select.trigger("menu")})},e.fn.toCustomRadioCheck=function(){return this.each(function(){var t=e(this),n=e("<span/>");t.is(":checkbox")?n.addClass("ideal-check"):n.addClass("ideal-radio"),t.is(":checked")&&n.addClass("checked"),n.insertAfter(t),e(this).parent("label").attr("onclick",""),t.css({position:"absolute",left:"-9999px"}).on({change:function(){var t=e(this);t.trigger("focus"),t.is(":radio")?(t.parent().siblings("label").children(".ideal-radio").removeClass("checked"),t.is(":checked")&&t.next(".ideal-radio").addClass("checked")):t.is(":checked")?n.addClass("checked"):n.removeClass("checked")},focus:function(){n.parent().addClass("focus")},blur:function(){n.parent().removeClass("focus")},click:function(){e(this).trigger("focus")}})})},e.fn.toCustomFile=function(){return this.each(function(){var t=e(this),n=e('<div class="ideal-file-wrap">'),r=e('<input type="text" class="ideal-file-filename" />'),i=e('<button type="button" class="ideal-file-upload">Open</button>');t.css({position:"absolute",left:"-9999px"}),i.click(function(){t.trigger("click")}),t.on({change:function(){var n=typeof e("input")[0].multiple!="undefined",i=[],s,o;if(n){s=t[0].files;for(var u=0,a=s.length;u<a;u++)i.push(s[u].name);o=i.join(", ")}else o=t.val().split("\\").pop();r.val(o),r.attr("title",o)},focus:function(){r.trigger("focus")}}),r.on({keyup:function(){t.trigger("change")},focus:function(){t.trigger("change")},blur:function(){t.trigger("blur")},keydown:function(e){e.which===13&&t.trigger("click")}}),n.append(i,r).insertAfter(t)})};var n={number:{regex:/\d+/,error:"Must be a number."},digits:{regex:/^\d+$/,error:"Must be only digits."},name:{regex:/^[A-Za-z]{3,}$/,error:"Must be at least 3 characters long, and must only contain letters."},username:{regex:/^[a-z](?=[\w.]{3,31}$)\w*\.?\w*$/i,error:"Must be at between 4 and 32 characters long and start with a letter. You may use letters, numbers, underscores, and one dot (.)"},pass:{regex:/(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{6,}/,error:"Must be at least 6 characters long, and contain at least one number, one uppercase and one lowercase letter."},strongpass:{regex:/(?=^.{8,}$)((?=.*\d)|(?=.*\W+))(?![.\n])(?=.*[A-Z])(?=.*[a-z]).*$/,error:"Must be at least 8 characters long and contain at least one uppercase and one lowercase letter and one number or special character."},email:{regex:/^(?:[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?\.)+[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-zA-Z0-9-]*[a-zA-Z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])$/,error:"Must be a valid e-mail address. <em>(e.g. user@gmail.com)</em>"},phone:{regex:/^[2-9]\d{2}-\d{3}-\d{4}$/,error:"Must be a valid US phone number. <em>(e.g. 555-123-4567)</em>"},zip:{regex:/^\d{5}$|^\d{5}-\d{4}$/,error:"Must be a valid US zip code. <em>(e.g. 33245 or 33245-0003)</em>"},url:{regex:/^(?:(ftp|http|https):\/\/)?(?:[\w\-]+\.)+[a-z]{3,6}$/i,error:"Must be a valid URL. <em>(e.g. www.google.com)</em>"},min:{regex:function(e,t){var n=e.input,r=e.userOptions.data.min;return n.is(":checkbox, :radio")?(this.error="Check at least <strong>"+r+"</strong>",n.filter(":checked").length>=r):(this.error="Must be at least <strong>"+r+"</strong> characters long.",t.length>=r)}},max:{regex:function(e,t){var n=e.input,r=e.userOptions.data.max;return n.is(":checkbox, :radio")?(this.error="Check no more than <strong>"+r+"</strong>.",n.filter(":checked").length<=r):(this.error="<strong>"+r+"</strong> characters max.",t.length<=r)}},date:{regex:function(e,t){var n=e.userOptions.data?e.userOptions.data.date:"mm/dd/yyyy",r=/[^mdy]/.exec(n)[0],i=n.split(r),s=t.split(r),o=function(e,t){var n,r,i;for(var s=0,o=t.length;s<o;s++)/m/.test(t[s])&&(n=e[s]),/d/.test(t[s])&&(r=e[s]),/y/.test(t[s])&&(i=e[s]);return n>0&&n<13&&i&&i.length===4&&r>0&&r<=(new Date(i,n,0)).getDate()};return this.error="Must be a valid date. <em>(e.g. "+n+")</em>",o(s,i)}},exclude:{regex:function(t,n){return this.error='"'+n+'" is not available.',!~e.inArray(n,t.userOptions.data.exclude)}},equalto:{regex:function(t,n){var r=e(t.userOptions.data.equalto),i=t.input,s=r.attr("name")||r.attr("id");return this.error='Must be the same value as <strong>"'+s+'"</strong>',r.parents(".ideal-field").filter(function(){return e(this).data("isValid")===!1}).length?!1:i.val()===r.val()}}},r={noerror:function(e){e.parent().siblings(".error").hide()},noicons:function(e){e.siblings(".valid-icon, .invalid-icon").hide()},novalidicon:function(e){e.siblings(".valid-icon").hide()},noinvalidicon:function(e){e.siblings(".invalid-icon").hide()},noclass:function(e){e.parents(".ideal-field").removeClass("valid invalid")},novalidclass:function(e){e.parents(".ideal-field").removeClass("valid")},noinvalidclass:function(e){e.parents(".ideal-field").removeClass("invalid")}};e.fn.idealforms=function(i){var s=e.extend({inputs:{},customFilters:{},customFlags:{},globalFlags:"",onSuccess:function(e){alert("Thank you...")},onFail:function(){alert("The form does not validate! Check again...")},responsiveAt:"auto",customInputs:!0},i),o=this,u={inputs:o.find("input, select, textarea, :button"),labels:o.find("label:first-child"),text:o.find("input:not(:checkbox, :radio), textarea"),select:o.find("select"),radiocheck:o.find("input:radio, input:checkbox"),buttons:o.find(":button"),file:o.find(":file")},a=e('[name="'+t.getKeys(s.inputs).join('"], [name="')+'"],'+"input."+t.getKeys(n).join(", .")+", input.required"),f={fieldWidth:t.getLessVar("ideal-field-width","width")},l={init:function(){var n=e('<span class="error" />'),r=e('<i class="icon valid-icon" />'),i=e("<i/>",{"class":"icon invalid-icon",click:function(){var t=e(this);t.siblings("label").length?t.siblings("label:first").find("input").focus():t.siblings("input, select, textarea").focus()}});o.css("visibility","visible").addClass("ideal-form"),o.children("div").addClass("ideal-wrap"),o.attr("novalidate","novalidate"),u.inputs.attr("autocomplete","off"),u.labels.addClass("ideal-label").width(t.getMaxWidth(u.labels)),u.text.add(u.select).each(function(){var t=e(this);t.wrapAll('<span class="ideal-field"/>')}),u.radiocheck.parents(".ideal-wrap").each(function(){e(this).find("label:not(.ideal-label)").wrapAll('<span class="ideal-field ideal-radiocheck"/>')}),a.parents(".ideal-field").append(r.add(i)).after(n.hide()),s.customInputs&&(u.buttons.addClass("ideal-button"),u.select.toCustomSelect(),u.radiocheck.toCustomRadioCheck(),u.file.toCustomFile()),"placeholder"in e("<input/>")[0]||u.text.each(function(){e(this).val(e(this).attr("placeholder"))}).on({focus:function(){this.value===e(this).attr("placeholder")&&e(this).val("")},blur:function(){e(this).val()||e(this).val(e(this).attr("placeholder"))}})}(),validate:function(e,r){var i=!0,s="",o=e.input,u=e.userOptions,a=u.filters;if(a){!r&&/required/.test(a)&&(s=u.errors&&u.errors.required?u.errors.required:"This field is required.",i=!1);if(r){a=a.split(/\s/);for(var f=0,l=a.length;f<l;f++){var c=a[f],h=n[c]||"";if(h&&(t.isFunction(h.regex)&&!h.regex(e,r)||t.isRegex(h.regex)&&!h.regex.test(r))){i=!1,s=u.errors&&u.errors[c]||h.error;break}}}}return{isValid:i,error:s}},analyze:function(e,t){var n=e.is(":checkbox, :radio"),i=e.is(":file"),o=function(){return n?a.filter('[name="'+e.attr("name")+'"]'):a.filter(e)}(),u=s.inputs[e.attr("name")]||{filters:e.attr("class")},f=function(){var t=e.val();if(t===e.attr("placeholder"))return;return n?u&&" ":t}(),c=e.parents(".ideal-field"),h=c.next(".error"),p=function(){return n?e.parent().siblings(".invalid-icon"):e.siblings(".invalid-icon")}(),d=function(){return n?e.parent().siblings(".valid-icon"):e.siblings(".valid-icon")}(),v=l.validate({input:o,userOptions:u},f),m=function(){var e=u.flags?u.flags:"";return s.globalFlags&&(e+=s.globalFlags),e.split(/\s/)}(),g=function(){for(var e=0,n=m.length,i;e<n;e++){i=m[e];if(!r[i])break;r[i](o,t)}};c.removeClass("valid invalid").data("isValid",!0),h.add(p).add(d).hide(),f&&v.isValid&&(h.add(p).hide(),c.addClass("valid").data("isValid",!0),d.show()),v.isValid||(p.show(),c.addClass("invalid").data("isValid",!1),t!=="blur"&&h.html(v.error).show()),g()},responsive:function(){var t=f.fieldWidth+u.labels.outerWidth(),n=u.labels.filter(function(){return e(this).html()==="&nbsp;"}),r=u.select.next(".ideal-select");s.responsiveAt==="auto"?o.width()<t?o.addClass("stack"):o.removeClass("stack"):e(window).width()<s.responsiveAt?o.addClass("stack"):o.removeClass("stack"),o.is(".stack")?(n.hide(),r.trigger("list")):(n.show(),r.trigger("menu"))}},c={getInvalid:function(){return o.find(".ideal-field").filter(function(){return e(this).data("isValid")===!1})},isValid:function(){return!o.getInvalid().length},isValidField:function(t){var n=e('[name="'+t+'"]').length?e('[name="'+t+'"]'):e("#"+t);return n.parents(".ideal-field").data("isValid")===!1},focusFirst:function(){return o.find("input:first").focus(),o},focusFirstInvalid:function(){return o.getInvalid().first().find("input:first").focus(),o},fresh:function(){return a.blur().parents(".ideal-field").removeClass("valid invalid"),o},reset:function(){return u.text.val(""),u.radiocheck.removeAttr("checked"),u.select.find("option").first().prop("selected",!0),o.find(".ideal-select").trigger("reset"),u.inputs.change().blur(),o.focusFirst(),o}};for(var h in c)o[h]=c[h];return a.on("keyup change focus blur",function(t){l.analyze(e(this),t.type)}),o.fresh(),o.on({keydown:function(e){e.which===13&&e.preventDefault()},submit:function(e){o.isValid()?s.onSuccess(e):(e.preventDefault(),s.onFail(),o.focusFirstInvalid())}}),s.responsiveAt&&(e(window).resize(l.responsive),l.responsive()),e.extend(!0,n,s.customFilters),e.extend(!0,r,s.customFlags),this}})(jQuery);